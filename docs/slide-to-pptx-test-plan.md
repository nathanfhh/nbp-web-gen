# Slide to PPTX 測試計劃

## 測試前置準備

1. 上傳一份 **3 頁的 PDF**
2. 設定方式：
   - **第 1 頁**：使用 OpenCV 方法
   - **第 2 頁**：使用 Gemini 方法
   - **第 3 頁**：使用 Gemini 方法
3. 點擊「開始轉換」完成初始處理
4. 確認三頁都處理完成（狀態為 done）

---

## 測試案例

### 一、進階設定測試

#### Test 1.1：版面分析參數變更（立即 remerge）

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 記錄第 1 頁目前的 merged regions 數量 | - |
| 2 | 點擊「進階設定」開啟 OcrSettingsModal | Modal 開啟 |
| 3 | 調整 `verticalCutThreshold` 數值（例如從 1.5 改成 3.0） | 滑桿移動，顯示「已修改」標籤 |
| 4 | 點擊「確認」關閉 Modal | Modal 關閉 |
| 5 | 檢查第 1 頁的 merged regions | ✅ 數量可能改變（取決於原始版面） |
| 6 | 檢查 Log 區域 | ✅ 應顯示「已重新合併 X 張投影片」 |
| 7 | **無需重新處理** | ✅ 不會觸發 OCR 或 Inpaint |

#### Test 1.2：OCR 參數變更（下次處理才生效）

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 點擊「進階設定」開啟 OcrSettingsModal | Modal 開啟 |
| 2 | 調整 `threshold`（例如從 0.3 改成 0.5） | 滑桿移動 |
| 3 | 點擊「確認」關閉 Modal | Modal 關閉 |
| 4 | 檢查目前的 OCR 結果 | ✅ **不變**（需要重新處理才會套用） |
| 5 | 重新上傳同一份 PDF 並處理 | ✅ 新的 threshold 會影響偵測結果 |

---

### 二、編輯模式測試 - OpenCV（第 1 頁）

#### Test 2.1：僅分隔線變更

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 切換到第 1 頁（OpenCV 方法） | - |
| 2 | 點擊「編輯區域」進入編輯模式 | Lightbox 開啟，顯示原始圖片 |
| 3 | 在兩個文字區域之間**繪製一條分隔線** | 分隔線顯示在畫面上 |
| 4 | 點擊「完成」退出編輯模式 | Lightbox 關閉 |
| 5 | 檢查 merged regions | ✅ 被分隔線切開的區域應分成兩個 |
| 6 | 檢查背景圖 | ✅ **不變**（沒有重新 inpaint） |
| 7 | **不應顯示任何 Modal** | ✅ 直接 remerge，無確認對話框 |

#### Test 2.2：區域變更 + OpenCV（直接重新處理）

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 切換到第 1 頁（OpenCV 方法） | - |
| 2 | 點擊「編輯區域」進入編輯模式 | Lightbox 開啟 |
| 3 | **刪除一個文字區域** | 區域從畫面上消失 |
| 4 | 點擊「完成」退出編輯模式 | - |
| 5 | 檢查處理狀態 | ✅ 顯示「正在重新處理...」 |
| 6 | **不應顯示任何 Modal** | ✅ OpenCV 直接處理，無需確認 |
| 7 | 處理完成後檢查背景圖 | ✅ 被刪除區域的文字應被移除 |
| 8 | 檢查 Toast | ✅ 顯示「重新處理完成」 |

#### Test 2.3：無變更直接退出

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 點擊「編輯區域」進入編輯模式 | Lightbox 開啟 |
| 2 | **不做任何操作** | - |
| 3 | 點擊「完成」退出編輯模式 | Lightbox 關閉 |
| 4 | 檢查處理狀態 | ✅ **不處理**（沒有任何變更） |

---

### 三、編輯模式測試 - Gemini（第 2 頁）

#### Test 3.1：僅分隔線變更（不觸發 Modal）

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 切換到第 2 頁（Gemini 方法） | - |
| 2 | 點擊「編輯區域」進入編輯模式 | Lightbox 開啟 |
| 3 | **只繪製分隔線**，不修改區域 | 分隔線顯示 |
| 4 | 點擊「完成」退出編輯模式 | - |
| 5 | 檢查是否顯示 Modal | ✅ **不顯示** Modal（僅分隔線變更） |
| 6 | 檢查 merged regions | ✅ 應正確分割 |
| 7 | 檢查背景圖 | ✅ **不變**（沒有呼叫 Gemini API） |

#### Test 3.2：區域變更 + Gemini（顯示確認 Modal）

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 切換到第 2 頁（Gemini 方法） | - |
| 2 | 點擊「編輯區域」進入編輯模式 | Lightbox 開啟 |
| 3 | **刪除一個文字區域** | 區域消失 |
| 4 | 點擊「完成」退出編輯模式 | - |
| 5 | 檢查是否顯示 Modal | ✅ **顯示**「確認重新生成背景」Modal |
| 6 | 檢查 Modal 內容 | ✅ 左側原圖、右側上次結果、額外指示輸入框 |
| 7 | 檢查 Modal 是否有 X 按鈕 | ✅ **沒有** X 按鈕 |

#### Test 3.3：Modal 互動測試 - 無法關閉

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 承 Test 3.2，Modal 已開啟 | - |
| 2 | **點擊 Modal 外部（黑色背景）** | ✅ **不關閉** Modal |
| 3 | **按下 ESC 鍵** | ✅ **不關閉** Modal |
| 4 | Modal 仍然開啟 | ✅ 只能透過下方按鈕操作 |

#### Test 3.4：選擇「使用現有圖片」

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 承 Test 3.2，Modal 已開啟 | - |
| 2 | 在「額外指示」輸入框輸入一些文字 | 例如「保留 Logo」 |
| 3 | 點擊「使用現有圖片」按鈕 | Modal 關閉 |
| 4 | 檢查背景圖 | ✅ **不變**（沒有呼叫 Gemini API） |
| 5 | 檢查 Toast | ✅ 顯示「已跳過重新生成，僅更新文字框位置」 |
| 6 | 檢查 merged regions | ✅ 應正確反映刪除後的狀態 |

#### Test 3.5：選擇「重新生成」

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 再次編輯第 2 頁，刪除另一個區域 | 觸發 Modal |
| 2 | 在「額外指示」輸入「注意圖表邊緣」 | 輸入文字 |
| 3 | 點擊「重新生成」按鈕 | Modal 關閉 |
| 4 | 檢查處理狀態 | ✅ 顯示「正在重新處理...」 |
| 5 | 檢查 Log | ✅ 應顯示 Gemini API 呼叫相關訊息 |
| 6 | 處理完成後檢查背景圖 | ✅ 應為新生成的背景（被刪除區域的文字已移除） |
| 7 | 檢查圖片尺寸 | ✅ 應與原圖尺寸一致（自動縮放） |

---

### 四、自訂提示詞持久化測試（第 3 頁）

#### Test 4.1：提示詞保存與預填

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 切換到第 3 頁（Gemini 方法） | - |
| 2 | 進入編輯模式，刪除一個區域 | 觸發 Modal |
| 3 | 在「額外指示」輸入「保留左上角 Logo」 | - |
| 4 | 點擊「重新生成」 | 處理完成 |
| 5 | **再次進入編輯模式** | Lightbox 開啟 |
| 6 | 刪除另一個區域 | 觸發 Modal |
| 7 | 檢查「額外指示」輸入框 | ✅ **預填**「保留左上角 Logo」 |

#### Test 4.2：提示詞清空

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 承 Test 4.1，Modal 已開啟 | - |
| 2 | **清空**「額外指示」輸入框 | 輸入框變空 |
| 3 | 點擊「重新生成」 | 處理完成 |
| 4 | 再次編輯並觸發 Modal | - |
| 5 | 檢查「額外指示」輸入框 | ✅ **空白**（已清空） |

---

### 五、Undo/Redo 測試

#### Test 5.1：Undo 分隔線操作

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 進入編輯模式 | - |
| 2 | 繪製一條分隔線 | 分隔線顯示 |
| 3 | 點擊 Undo 按鈕 | ✅ 分隔線消失 |
| 4 | 點擊 Redo 按鈕 | ✅ 分隔線恢復 |

#### Test 5.2：Undo 區域刪除

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 進入編輯模式 | - |
| 2 | 刪除一個文字區域 | 區域消失 |
| 3 | 點擊 Undo 按鈕 | ✅ 區域恢復 |
| 4 | 點擊「完成」退出 | - |
| 5 | 檢查是否觸發 Modal（Gemini）或重新處理（OpenCV） | ✅ **不觸發**（因為 Undo 後等於沒變更） |

---

### 六、重設區域測試

#### Test 6.1：重設到原始狀態

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 選擇任一頁，進入編輯模式 | - |
| 2 | 刪除多個區域、繪製分隔線 | 做各種修改 |
| 3 | 點擊「重設」按鈕 | - |
| 4 | 檢查區域 | ✅ 恢復到 OCR 原始結果 |
| 5 | 檢查分隔線 | ✅ 全部清除 |
| 6 | 檢查背景圖 | ✅ 恢復到 originalCleanImage |
| 7 | 點擊「完成」退出 | ✅ **不觸發** Modal 或重新處理（因為是原始狀態） |

---

### 七、混合操作測試

#### Test 7.1：區域 + 分隔線同時變更

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 切換到第 2 頁（Gemini 方法） | - |
| 2 | 進入編輯模式 | - |
| 3 | 刪除一個區域 **且** 繪製一條分隔線 | 兩種操作都做 |
| 4 | 點擊「完成」退出 | - |
| 5 | 檢查是否顯示 Modal | ✅ **顯示** Modal（因為區域有變更） |
| 6 | 選擇「重新生成」 | - |
| 7 | 檢查結果 | ✅ 背景重新生成 + 分隔線切割效果同時套用 |

---

## 測試結果記錄表

| 測試案例 | 通過 | 備註 |
|----------|------|------|
| Test 1.1 | ☐ | |
| Test 1.2 | ☐ | |
| Test 2.1 | ☐ | |
| Test 2.2 | ☐ | |
| Test 2.3 | ☐ | |
| Test 3.1 | ☐ | |
| Test 3.2 | ☐ | |
| Test 3.3 | ☐ | |
| Test 3.4 | ☐ | |
| Test 3.5 | ☐ | |
| Test 4.1 | ☐ | |
| Test 4.2 | ☐ | |
| Test 5.1 | ☐ | |
| Test 5.2 | ☐ | |
| Test 6.1 | ☐ | |
| Test 7.1 | ☐ | |
