# 角色庫

角色庫讓你儲存和重複使用角色設定，確保跨多次生成的角色一致性。

## 基本概念

當你需要多次生成同一個角色（例如在故事模式中），角色庫可以：

- 儲存角色的外觀描述
- 儲存角色的參考圖片
- 在生成時自動注入角色資訊

## 建立角色

有兩種方式可以建立角色：

### 方式一：從貼圖模式進入萃取器

在「貼圖」模式中生成角色貼圖後，點擊貼圖上的萃取按鈕，即可將該貼圖帶入角色萃取器進行萃取。

### 方式二：直接使用角色萃取器

![角色萃取器](/images/character-library.webp)

1. 進入「角色萃取器」頁面（從角色庫點擊「+」按鈕）
2. 上傳一張角色圖片
3. 點擊「萃取角色」按鈕
4. AI 會自動分析並列出角色的特徵：
   - **描述**：角色的整體描述
   - **外觀特徵**：髮型、眼睛、臉型、體型、膚色
   - **服裝**：角色的穿著
   - **配件**：眼鏡、帽子等配件
   - **特殊特徵**：角色的獨特之處
5. 為角色命名並儲存

::: info 關於 API 金鑰使用
角色萃取屬於文字處理功能，會優先使用 Free Tier API Key。詳見 [API Key 管理](./api-key-management)。
:::

## 角色資訊

每個角色包含以下資訊：

- **名稱**：角色的識別名稱
- **參考圖片**：用於萃取的原始圖片（儲存在 OPFS）
- **描述**：角色的整體描述
- **外觀特徵**：髮型、眼睛、臉型、體型、膚色
- **服裝**：角色的穿著描述
- **配件**：眼鏡、帽子等配件
- **特殊特徵**：角色的獨特之處

## 使用角色

### 在生成時選擇

1. 在首頁下方的「我的角色庫」選擇角色
2. 選取的角色圖片會自動加入參考圖片
3. 生成時 AI 會參考角色的外觀特徵

### 在故事模式中使用

故事模式特別適合使用角色庫：

1. 開始新故事前選擇角色
2. 角色圖片會作為參考，確保外觀一致
3. 每一幕都會自動參考角色設定

## 管理角色

### 編輯角色

點擊角色庫中的編輯按鈕，會進入角色萃取器頁面進行編輯：

- 修改角色名稱
- 更新描述或特徵
- 更換參考圖片（重新上傳）

### 刪除角色

刪除角色會同時刪除：
- 角色資料（IndexedDB）
- 參考圖片（OPFS）

::: warning 注意
刪除操作無法復原，請謹慎操作。
:::

## 匯出與匯入

角色庫支援匯出和匯入功能，方便你在不同瀏覽器或裝置間備份和還原角色。

### 匯出角色

1. 在角色庫中選擇要匯出的角色
2. 點擊匯出按鈕
3. 下載 JSON 檔案（包含角色資訊和參考圖片）

### 匯入角色

1. 點擊匯入按鈕
2. 選擇之前匯出的 JSON 檔案
3. 系統會自動檢測重複的角色（依據 UUID），避免重複匯入

::: tip 跨裝置同步
你也可以透過 P2P 連線功能，將角色即時同步到另一台裝置。詳見 [歷史紀錄](./history) 中的「跨裝置傳輸」說明。
:::

## 儲存位置

角色資料儲存在瀏覽器中：

| 資料類型 | 儲存位置 |
|----------|----------|
| 角色資訊 | IndexedDB |
| 參考圖片 | OPFS |

清除瀏覽器資料會刪除所有角色。

## 下一步

- [故事模式](./story-mode) - 使用角色創作故事
- [圖片編輯](./image-editing) - 編輯角色圖片
